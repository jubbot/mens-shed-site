---
/**
 * RotatingQuotes.astro — ultra-reliable version
 * - Auto-rotates every `intervalMs` (default 10000ms)
 * - Minimal JS, no observers, no hover logic
 */
const { intervalMs = 10000 } = Astro.props;

const QUOTES = [
  { text: "Alone we can do so little; together we can do so much.", author: "Helen Keller" },
  { text: "If you want to go fast, go alone. If you want to go far, go together.", author: "African Proverb" },
  { text: "We rise by lifting others.", author: "Robert G. Ingersoll" },
  { text: "Many hands make light work.", author: "Proverb" },
  { text: "Measure twice, cut once.", author: "Carpenter’s Proverb" },
  { text: "The best way to find yourself is to lose yourself in the service of others.", author: "Mahatma Gandhi" },
  { text: "It is not how much we give but how much love we put into giving.", author: "Mother Teresa" },
  { text: "The simple act of caring is heroic.", author: "Edward Albert" },
  { text: "No one has ever become poor by giving.", author: "Anne Frank" },
  { text: "Community is much more than belonging; it's about doing together what matters.", author: "Brian Solis" },
  { text: "The best way to predict the future is to create it.", author: "Peter Drucker" },
  { text: "Small deeds done are better than great deeds planned.", author: "Peter Marshall" },
  { text: "Never doubt that a small group of thoughtful, committed citizens can change the world.", author: "Margaret Mead" },
  { text: "Wherever there is a human being, there is an opportunity for kindness.", author: "Seneca" },
  { text: "Quality is never an accident; it is always the result of intelligent effort.", author: "John Ruskin" },
  { text: "The details are not the details. They make the design.", author: "Charles Eames" },
  { text: "Coming together is a beginning; keeping together is progress; working together is success.", author: "Henry Ford" },
  { text: "The true meaning of life is to plant trees under whose shade you do not expect to sit.", author: "Nelson Henderson" },
  { text: "A fair go for all.", author: "Australian Saying" }
];

const start = Math.floor(Math.random() * QUOTES.length);
---

<figure id="rotating-quotes" class="quotes-rotator" data-interval={intervalMs} data-index={start} aria-live="polite">
  <blockquote>“{QUOTES[start].text}”</blockquote>
  <figcaption>— {QUOTES[start].author}</figcaption>
</figure>

<script is:inline>
(() => {
  const root = document.getElementById('rotating-quotes');
  if (!root) return;

  const quotes = {JSON.stringify(QUOTES)};
  let i = parseInt(root.getAttribute('data-index') || '0', 10) || 0;
  const ms = Math.max(1000, parseInt(root.getAttribute('data-interval') || '10000', 10));

  const bq = root.querySelector('blockquote');
  const cap = root.querySelector('figcaption');

  function render(idx) {
    if (bq) bq.textContent = `“${quotes[idx].text}”`;
    if (cap) cap.textContent = `— ${quotes[idx].author}`;
  }

  function next() {
    i = (i + 1) % quotes.length;
    root.classList.add('is-fading');
    setTimeout(() => {
      render(i);
      root.classList.remove('is-fading');
    }, 150);
  }

  // Start rotating — hard guarantee
  setInterval(next, ms);
})();
</script>

<style>
  .quotes-rotator {
    margin-top: 1.25rem;
    padding: .9rem 1rem;
    border: 1px solid var(--card-stroke,#e3e3e3);
    border-radius: .75rem;
    background: var(--card-bg,#fff);
    transition: opacity .18s ease-in-out;
  }
  .quotes-rotator.is-fading { opacity: .25; }

  .quotes-rotator blockquote {
    margin: 0;
    font-size: 1.05rem;
    line-height: 1.5;
  }
  .quotes-rotator figcaption {
    margin-top: .4rem;
    font-size: .95rem;
    opacity: .75;
  }
</style>
