---
/**
 * Obfuscated call/email buttons (no raw phone/email in HTML).
 * Fallback: a link to /contact is shown.
 */
const {
  phone = '0747724422',
  email = 'townsvillemensshed@gmail.com',
  class: extraClass = ''
} = Astro.props;

// Mild obfuscation: reverse then base64 (many scrapers won't execute the click)
const enc = (s: string) => Buffer.from(s.split('').reverse().join('')).toString('base64');
const phonePayload = enc(phone);
const emailPayload = enc(email);
---

<div class={`contact-reveal ${extraClass}`}>
  <button type="button" class="btn btn-alpha" data-reveal="tel" data-payload={phonePayload}>
    <i class="wt-phone"></i> Call us
  </button>
  <button type="button" class="btn btn-delta" data-reveal="mailto" data-payload={emailPayload}>
    <i class="wt-mail"></i> Email us
  </button>
 
</div>

<script is:inline>
  const decode = (p) => {
    try { return atob(p).split('').reverse().join(''); } catch { return ''; }
  };

  document.addEventListener('click', (e) => {
    const btn = e.target.closest('[data-reveal]');
    if (!btn) return;
    const mode = btn.getAttribute('data-reveal');
    const payload = btn.getAttribute('data-payload') || '';
    const value = decode(payload);
    if (!value) return;

    if (mode === 'tel')   location.href = `tel:${value}`;
    if (mode === 'mailto') location.href = `mailto:${value}`;
  });
</script>

 