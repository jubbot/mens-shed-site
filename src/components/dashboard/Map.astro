<section class="au-geo">
  <h3>Visitors by State</h3>
  <div id="au-tiles" class="au-tiles" aria-label="Visitors by state"></div>
  <div class="au-legend" id="au-legend"></div>
</section>

<script is:inline>
const AU_NAMES = {
  NSW:"New South Wales", QLD:"Queensland", VIC:"Victoria", SA:"South Australia",
  WA:"Western Australia", TAS:"Tasmania", NT:"Northern Territory", ACT:"Australian Capital Territory"
};

// TODO: replace with fetch('/api/geo-au.json').then(r=>r.json())
const counts = { NSW:152, QLD:201, VIC:134, SA:37, WA:65, TAS:12, NT:7, ACT:19 }; // dummy

function renderAU(containerId, data) {
  const el = document.getElementById(containerId);
  const entries = Object.entries(AU_NAMES).map(([k, name]) => ({ code:k, name, value: Number(data[k]||0)}));
  const max = Math.max(1, ...entries.map(e=>e.value));
  el.innerHTML = '';
  entries.forEach(({code, name, value})=>{
    const tile = document.createElement('button');
    tile.className = 'au-tile';
    tile.style.setProperty('--v', (value/max).toString());
    tile.setAttribute('data-code', code);
    tile.setAttribute('title', `${name}: ${value.toLocaleString()}`);
    tile.innerHTML = `<span class="au-code">${code}</span><span class="au-val">${value.toLocaleString()}</span>`;
    el.appendChild(tile);
  });
  const leg = document.getElementById('au-legend');
  leg.innerHTML = `<span>0</span><span class="swatch"></span><span>${max.toLocaleString()}</span>`;
}
renderAU('au-tiles', counts);
</script>

<style>
.au-tiles{
  --gap:.35rem;
  display:grid; gap:var(--gap);
  grid-template-columns: repeat(6, minmax(44px,1fr));
  grid-auto-rows: 46px;
  /* tile-map layout (approx. geography) */
  grid-template-areas:
    ".  .   wa  wa  nt  qld"
    ".  sa  sa  nt  qld qld"
    ".  sa  sa  nsw nsw act"
    ".  vic vic nsw nsw tas"
    ".  vic vic .   .   tas";
}
.au-tile{
  appearance:none; border:1px solid var(--line,#d0d5db); border-radius:.5rem;
  background-color: hsl(160 70% calc(92% - var(--v,0)*40%));
  color: var(--text,#111); display:flex; flex-direction:column; align-items:center; justify-content:center;
  font-weight:600; line-height:1; cursor:default;
}
.au-tile:hover{ outline:2px solid var(--accent,#0a7); outline-offset:2px; }
.au-code{ font-size:.8rem; opacity:.8; letter-spacing:.02em; }
.au-val{ font-size:.95rem; margin-top:.15rem; font-variant-numeric:tabular-nums; }

.au-legend{ display:flex; align-items:center; gap:.4rem; margin-top:.5rem; font-size:.85rem; }
.au-legend .swatch{
  flex:1; height:.6rem; border-radius:.3rem;
  background: linear-gradient(to right, hsl(160 70% 92%), hsl(160 70% 52%));
  border:1px solid var(--line,#d0d5db);
}
/* place tiles */
.au-tile[data-code="WA"] { grid-area: wa; }
.au-tile[data-code="NT"] { grid-area: nt; }
.au-tile[data-code="QLD"]{ grid-area: qld; }
.au-tile[data-code="NSW"]{ grid-area: nsw; }
.au-tile[data-code="ACT"]{ grid-area: act; }
.au-tile[data-code="VIC"]{ grid-area: vic; }
.au-tile[data-code="SA"] { grid-area: sa; }
.au-tile[data-code="TAS"]{ grid-area: tas; }

/* dark mode */
@media (prefers-color-scheme: dark){
  .au-tile{ border-color:#374151; color:#f3f4f6; background-color: hsl(160 60% calc(22% + var(--v,0)*18%)); }
  .au-legend .swatch{ border-color:#374151; background: linear-gradient(to right, hsl(160 60% 22%), hsl(160 60% 40%)); }
}
</style>
